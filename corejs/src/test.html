<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>WebGme Test</title>
<script src="require.js"></script>
</head>
<body>
Test
<script>
	require(["flattable", "values", "services"], function(Table, values, services) {

		var table = new Table();
		var objects = values.create(table);
		var query = services.query(objects);

		var row0 = table.getRow("a");
		var row1 = table.getRow("b");
		
		var logRow = function(row) {
			var name = table.getId(row);
			console.log(name + "\tpattern: " + JSON.stringify(query.patterns.get(row)));
			console.log("\tterritory " + query.territory.get(row));
			console.log("\tvalue: " + JSON.stringify(objects.get(row)));
		}
		
		var log = function() {
			logRow(row0);
			logRow(row1);
			console.log("dirty: " + query.isDirty());
			console.log("loaded: " + query.isLoaded());
			console.log("");
		}

		log();
		
		query.patterns.set(row0, {children:true});
		log();
		
		objects.set(row0, {children: ["b"]});
		objects.set(row1, {});
		log();
		
		query.execute();
		log();
		
		console.log("done");
	});
	</script>
</body>
</html>